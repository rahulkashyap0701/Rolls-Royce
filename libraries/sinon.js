this.sinon=function(){var samsam,formatio;function define(e,t,n){"samsam"==e?samsam=t():formatio=n(samsam)}define.amd=!0,(("function"==typeof define&&define.amd?function(e){define("samsam",e)}:"object"==typeof module&&function(e){module.exports=e()})||function(e){this.samsam=e()})(function(){var s,R=Object.prototype,t="undefined"!=typeof document&&document.createElement("div");function M(e){return"number"==typeof e&&e!==e}function L(e){return R.toString.call(e).split(/[ \]]/)[1]}function I(e){if("object"!=typeof e||"number"!=typeof e.length||"Array"===L(e))return!1;if("function"==typeof e.callee)return!0;try{e[e.length]=6,delete e[e.length]}catch(e){return!0}return!1}function P(e){if(!e||1!==e.nodeType||!t)return!1;try{e.appendChild(t),e.removeChild(t)}catch(e){return!1}return!0}function H(e){var t,n=[];for(t in e)R.hasOwnProperty.call(e,t)&&n.push(t);return n}function N(e){return"function"==typeof e.getTime&&e.getTime()==e.valueOf()}function n(e){return 0===e&&1/e==-1/0}function F(e,t){if(e===t||M(e)&&M(t))return 0!==e||n(e)===n(t)}return{isArguments:I,isElement:P,isDate:N,isNegZero:n,identical:F,deepEqual:function(e,t){var k=[],T=[],E=[],q=[],S={};function j(e){return!("object"!=typeof e||null===e||e instanceof Boolean||e instanceof Date||e instanceof Number||e instanceof RegExp||e instanceof String)}function O(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1}return function e(t,n,r,i){var o=typeof t,s=typeof n;if(t===n||M(t)||M(n)||null==t||null==n||"object"!=o||"object"!=s)return F(t,n);if(P(t)||P(n))return!1;var a=N(t),l=N(n);if((a||l)&&(!a||!l||t.getTime()!==n.getTime()))return!1;if(t instanceof RegExp&&n instanceof RegExp&&t.toString()!==n.toString())return!1;var c,u,h,f,p,d,y,m,g,v,w,b=L(t),x=L(n),C=H(t),A=H(n);if(I(t)||I(n)){if(t.length!==n.length)return!1}else if(o!=s||b!==x||C.length!==A.length)return!1;for(u=0,h=C.length;u<h;u++){if(c=C[u],!R.hasOwnProperty.call(n,c))return!1;if(f=t[c],p=n[c],d=j(f),y=j(p),m=d?O(k,f):-1,g=y?O(T,p):-1,v=-1!==m?E[m]:r+"["+JSON.stringify(c)+"]",w=-1!==g?q[g]:i+"["+JSON.stringify(c)+"]",S[v+w])return!0;if(-1===m&&d&&(k.push(f),E.push(v)),-1===g&&y&&(T.push(p),q.push(w)),d&&y&&(S[v+w]=!0),!e(f,p,v,w))return!1}return!0}(e,t,"$1","$2")},match:s=function e(t,n){if(n&&"function"==typeof n.test)return n.test(t);if("function"==typeof n)return!0===n(t);var r;if("string"==typeof n)return n=n.toLowerCase(),("string"==typeof t||!!t)&&0<=String(t).toLowerCase().indexOf(n);if("number"==typeof n)return n===t;if("boolean"==typeof n)return n===t;if("Array"===L(t)&&"Array"===L(n))return function(e,t){if(0===t.length)return!0;for(var n,r,i=0,o=e.length;i<o;++i)if(s(e[i],t[0])){for(n=0,r=t.length;n<r;++n)if(!s(e[i+n],t[n]))return!1;return!0}return!1}(t,n);if(n&&"object"==typeof n){for(r in n)if(!e(t[r],n[r]))return!1;return!0}throw new Error("Matcher was not a string, a number, a function, a boolean or an object")},keys:H}}),(("function"==typeof define&&define.amd?function(e){define("formatio",["samsam"],e)}:"object"==typeof module&&function(e){module.exports=e(require("samsam"))})||function(e){this.formatio=e(this.samsam)})(function(d){var s={excludeConstructors:["Object",/^.$/],quoteStrings:!0},a=(Object.prototype.hasOwnProperty,[]);function l(e){if(!e)return"";if(e.displayName)return e.displayName;if(e.name)return e.name;var t=e.toString().match(/function\s+([^\(]+)/m);return t&&t[1]||""}function y(e,t){for(var n=l(t&&t.constructor),r=e.excludeConstructors||s.excludeConstructors||[],i=0,o=r.length;i<o;++i){if("string"==typeof r[i]&&r[i]===n)return"";if(r[i].test&&r[i].test(n))return""}return n}function m(e,t){if("object"==typeof e)for(var n=0,r=t.length;n<r;++n)if(t[n]===e)return 1}function g(e,t,n,r){if("string"==typeof t){var i=e.quoteStrings;return n||("boolean"!=typeof i||i)?'"'+t+'"':t}if("function"==typeof t&&!(t instanceof RegExp))return g.func(t);if(m(t,n=n||[]))return"[Circular]";if("[object Array]"===Object.prototype.toString.call(t))return g.array.call(e,t,n);if(!t)return String(1/t==-1/0?"-0":t);if(d.isElement(t))return g.element(t);if("function"==typeof t.toString&&t.toString!==Object.prototype.toString)return t.toString();for(var o=0,s=a.length;o<s;o++)if(t===a[o].object)return a[o].value;return g.object.call(e,t,n,r)}function t(e){for(var t in e)this[t]=e[t]}return"undefined"!=typeof global&&a.push({object:global,value:"[object global]"}),"undefined"!=typeof document&&a.push({object:document,value:"[object HTMLDocument]"}),"undefined"!=typeof window&&a.push({object:window,value:"[object Window]"}),g.func=function(e){return"function "+l(e)+"() {}"},g.array=function(e,t){(t=t||[]).push(e);for(var n=[],r=0,i=e.length;r<i;++r)n.push(g(this,e[r],t));return"["+n.join(", ")+"]"},g.object=function(e,t,n){(t=t||[]).push(e),n=n||0;for(var r,i,o,s=[],a=d.keys(e).sort(),l=3,c=0,u=a.length;c<u;++c)i=m(o=e[r=a[c]],t)?"[Circular]":g(this,o,t,n+2),l+=(i=(/\s/.test(r)?'"'+r+'"':r)+": "+i).length,s.push(i);var h=y(this,e),f=h?"["+h+"] ":"",p="";for(c=0,u=n;c<u;++c)p+=" ";return 80<l+n?f+"{\n  "+p+s.join(",\n  "+p)+"\n"+p+"}":f+"{ "+s.join(", ")+" }"},g.element=function(e){for(var t,n,r,i=e.tagName.toLowerCase(),o=e.attributes,s=[],a=0,l=o.length;a<l;++a)n=(t=o.item(a)).nodeName.toLowerCase().replace("html:",""),r=t.nodeValue,"contenteditable"===n&&"inherit"===r||r&&s.push(n+'="'+r+'"');var c="<"+i+(0<s.length?" ":""),u=e.innerHTML;return 20<u.length&&(u=u.substr(0,20)+"[...]"),(c+s.join(" ")+">"+u+"</"+i+">").replace(/ contentEditable="inherit"/,"")},t.prototype={functionName:l,configure:function(e){return new t(e)},constructorName:function(e){return y(this,e)},ascii:function(e,t,n){return g(this,e,t,n)}}});var sinon=function(e){var n="undefined"!=typeof document&&document.createElement("div"),l=Object.prototype.hasOwnProperty;function a(e){return n&&e&&1===e.nodeType&&function(e){var t=!1;try{e.appendChild(n),t=n.parentNode==e}catch(e){return}finally{try{e.removeChild(n)}catch(e){}}return t}(e)}function r(e){return"function"==typeof e&&"function"==typeof e.restore&&e.restore.sinon}var c={wrapMethod:function(e,t,n){if(!e)throw new TypeError("Should wrap property of object");if("function"!=typeof n)throw new TypeError("Method wrapper should be function");var r,i,o,s=e[t];if("function"==typeof(r=s)||r&&r.constructor&&r.call&&r.apply||(o=new TypeError("Attempted to wrap "+typeof s+" property "+t+" as function")),s.restore&&s.restore.sinon&&(o=new TypeError("Attempted to wrap "+t+" which is already wrapped")),s.calledBefore&&(i=s.returns?"stubbed":"spied on",o=new TypeError("Attempted to wrap "+t+" which is already "+i)),o)throw s._stack&&(o.stack+="\n--------------\n"+s._stack),o;var a=e.hasOwnProperty?e.hasOwnProperty(t):l.call(e,t);return(e[t]=n).displayName=t,n._stack=new Error("Stack Trace for original").stack,n.restore=function(){a||delete e[t],e[t]===n&&(e[t]=s)},n.restore.sinon=!0,function(e,t){for(var n in t)l.call(e,n)||(e[n]=t[n])}(n,s),n},extend:function(e){for(var t=1,n=arguments.length;t<n;t+=1)for(var r in arguments[t])arguments[t].hasOwnProperty(r)&&(e[r]=arguments[t][r]),arguments[t].hasOwnProperty("toString")&&arguments[t].toString!=e.toString&&(e.toString=arguments[t].toString);return e},create:function(e){function t(){}return t.prototype=e,new t},deepEqual:function e(t,n){if(c.match&&c.match.isMatcher(t))return t.test(n);if("object"!=typeof t||"object"!=typeof n)return t===n;if(a(t)||a(n))return t===n;if(t===n)return!0;if(null===t&&null!==n||null!==t&&null===n)return!1;var r=Object.prototype.toString.call(t);if(r!=Object.prototype.toString.call(n))return!1;if("[object Date]"==r)return t.valueOf()===n.valueOf();var i,o=0,s=0;if("[object Array]"==r&&t.length!==n.length)return!1;for(i in t)if(o+=1,!e(t[i],n[i]))return!1;for(i in n)s+=1;return o==s},functionName:function(e){var t,n=e.displayName||e.name;return n||(n=(t=e.toString().match(/function ([^\s\(]+)/))&&t[1]),n},functionToString:function(){if(this.getCall&&this.callCount)for(var e,t,n=this.callCount;n--;)for(t in e=this.getCall(n).thisValue)if(e[t]===this)return t;return this.displayName||"sinon fake"},getConfig:function(e){var t={};e=e||{};var n=c.defaultConfig;for(var r in n)n.hasOwnProperty(r)&&(t[r]=e.hasOwnProperty(r)?e[r]:n[r]);return t},format:function(e){return""+e},defaultConfig:{injectIntoThis:!0,injectInto:null,properties:["spy","stub","mock","clock","server","requests"],useFakeTimers:!0,useFakeServer:!0},timesInWords:function(e){return(1==e?"once":2==e&&"twice")||3==e&&"thrice"||(e||0)+" times"},calledInOrder:function(e){for(var t=1,n=e.length;t<n;t++)if(!e[t-1].calledBefore(e[t])||!e[t].called)return!1;return!0},orderByFirstCall:function(e){return e.sort(function(e,t){var n=e.getCall(0),r=t.getCall(0);return(n&&n.callId||-1)<(r&&r.callId||-1)?-1:1})},log:function(){},logError:function(e,t){var n=e+" threw exception: ";c.log(n+"["+t.name+"] "+t.message),t.stack&&c.log(t.stack),setTimeout(function(){throw t.message=n+t.message,t},0)},typeOf:function(e){if(null===e)return"null";if(void 0===e)return"undefined";var t=Object.prototype.toString.call(e);return t.substring(8,t.length-1).toLowerCase()},createStubInstance:function(e){if("function"!=typeof e)throw new TypeError("The constructor should be a function.");return c.stub(c.create(e.prototype))},restore:function(e){if(null!==e&&"object"==typeof e)for(var t in e)r(e[t])&&e[t].restore();else r(e)&&e.restore()}},t="undefined"!=typeof module&&module.exports;if("function"==typeof define&&"object"==typeof define.amd&&define.amd)define(function(){return c});else if(t){try{e=require("formatio")}catch(e){}module.exports=c,module.exports.spy=require("./sinon/spy"),module.exports.spyCall=require("./sinon/call"),module.exports.behavior=require("./sinon/behavior"),module.exports.stub=require("./sinon/stub"),module.exports.mock=require("./sinon/mock"),module.exports.collection=require("./sinon/collection"),module.exports.assert=require("./sinon/assert"),module.exports.sandbox=require("./sinon/sandbox"),module.exports.test=require("./sinon/test"),module.exports.testCase=require("./sinon/test_case"),module.exports.assert=require("./sinon/assert"),module.exports.match=require("./sinon/match")}if(e){var i=e.configure({quoteStrings:!1});c.format=function(){return i.ascii.apply(i,arguments)}}else if(t)try{var o=require("util");c.format=function(e){return"object"==typeof e&&e.toString===Object.prototype.toString?o.inspect(e):e}}catch(e){}return c}("object"==typeof formatio&&formatio),ud,xd,Ad,vd,ye,Be,Ce,ze,Th,Zh,Uh,pi,si,ui,_i,aj,qi,ri,bk,ik,ck,dk,ek,sinon,em,sinon,Go,Ko,Lo,sinon,Rp,jq,kq,uq,vq,Nq,Oq,Rq,Pq,Qq;function wd(e,t,n){var r=ud.typeOf(e);if(r!==t)throw new TypeError("Expected type of "+n+" to be "+t+", but was "+r)}function yd(e){return xd.isPrototypeOf(e)}function Bd(i,o){return function(t,n){wd(t,"string","property");var r=1===arguments.length,e=o+'("'+t+'"';return r||(e+=", "+n),Ad(function(e){return!(null==e||!i(e,t))&&(r||ud.deepEqual(n,e[t]))},e+=")")}}function Ae(e,t,n){var r=ye.functionName(e)+t;throw n.length&&(r+=" Received ["+Be.call(n).join(", ")+"]"),new Error(r)}function De(e,t,n,r,i,o){if("number"!=typeof o)throw new TypeError("Call id is not a number");var s=ye.create(Ce);return s.proxy=e,s.thisValue=t,s.args=n,s.returnValue=r,s.exception=i,s.callId=o,s}function Vh(e,t,n){if(n&&"function"!=typeof n)throw new TypeError("Custom stub should be function");var r=n?Th.spy&&Th.spy.create?Th.spy.create(n):n:Vh.create();if(!e&&void 0===t)return Th.stub.create();if(void 0!==t||"object"!=typeof e)return Th.wrapMethod(e,t,r);for(var i in e)"function"==typeof e[i]&&Vh(e,i);return e}function Wh(e){return e.defaultBehavior||(t=e).parent&&Yh(t.parent)||Th.behavior.create(e);var t}function Yh(e){var t=e.behaviors[e.callCount-1];return t&&t.isPresent()?t:Wh(e)}function ti(e){return e?ti.create(e):pi.expectation.create("Anonymous mock")}function wi(e,t){if(e)for(var n=0,r=e.length;n<r;n+=1)t(e[n])}function ej(e){return"number"==typeof e.maxCalls&&e.callCount==e.maxCalls}function fj(e,t){return!si||!si.isMatcher(e)||e.test(t)}function fk(e){return e.fakes||(e.fakes=[]),e.fakes}function gk(e,t){for(var n=fk(e),r=0,i=n.length;r<i;r+=1)"function"==typeof n[r][t]&&n[r][t]()}function Ho(){}function Jo(e){var t=e;if("[object Array]"!=Object.prototype.toString.call(e)&&(t=[200,{},e]),"string"!=typeof t[2])throw new TypeError("Fake server response body should be string, but was "+typeof t[2]);return t}function No(e,t){var n,r,i,o,s,a,l,c=t.url;if(/^https?:\/\//.test(c)&&!Lo.test(c)||(c=c.replace(Lo,"")),n=e,r=this.getHTTPMethod(t),i=c,o=n.method,s=!o||o.toLowerCase()==r.toLowerCase(),a=n.url,l=!a||a==i||"function"==typeof a.test&&a.test(i),s&&l){if("function"!=typeof e.response)return!0;var u=e.url,h=[t].concat(u&&"function"==typeof u.exec?u.exec(c).slice(1):[]);return e.response.apply(e,h)}return!1}function Ep(){}function Sp(e,t,n,r){r&&(!t.injectInto||n in t.injectInto?Rp.call(e.args,r):t.injectInto[n]=r)}function lq(o){var e=typeof o;if("function"!=e)throw new TypeError("sinon.test needs to wrap a test function, got "+e);return function(){var e=jq.getConfig(jq.config);e.injectInto=e.injectIntoThis&&this||e.injectInto;var t,n,r=jq.sandbox.create(e),i=Array.prototype.slice.call(arguments).concat(r.args);try{n=o.apply(this,i)}catch(e){t=e}if(void 0!==t)throw r.restore(),t;return r.verifyAndRestore(),n}}function xq(e,t){if(!e||"object"!=typeof e)throw new TypeError("sinon.testCase needs an object with test functions");t=t||"test";var n,r,i,o=new RegExp("^"+t),s={},a=e.setUp,l=e.tearDown;for(n in e)if(e.hasOwnProperty(n)){if(r=e[n],/^(setUp|tearDown)$/.test(n))continue;"function"==typeof r&&o.test(n)?(i=r,(a||l)&&(i=function(n,r,i){return function(){var t,e;r&&r.apply(this,arguments);try{e=n.apply(this,arguments)}catch(e){t=e}if(i&&i.apply(this,arguments),t)throw t;return e}}(r,a,l)),s[n]=uq.test(i)):s[n]=e[n]}return s}function Sq(){for(var e,t=0,n=arguments.length;t<n;++t)(e=arguments[t])||Rq.fail("fake is not a spy"),"function"!=typeof e&&Rq.fail(e+" is not a function"),"function"!=typeof e.getCall&&Rq.fail(e+" is not stubbed")}function Tq(e,t){((e=e||Oq).fail||Rq.fail).call(e,t)}function Uq(n,r,i){2==arguments.length&&(i=r,r=n),Rq[n]=function(e){Sq(e);var t=Qq.call(arguments,1);("function"==typeof r?!r(e):"function"==typeof e[r]?!e[r].apply(e,t):!e[r])?Tq(this,e.printf.apply(e,[i].concat(t))):Rq.pass(n)}}return ud="object"==typeof sinon&&sinon||null,vd="undefined"!=typeof module&&module.exports,!ud&&vd&&(ud=require("../sinon")),ud&&(xd={toString:function(){return this.message},or:function(t){if(!yd(t))throw new TypeError("Matcher expected");var n=this,e=ud.create(xd);return e.test=function(e){return n.test(e)||t.test(e)},e.message=n.message+".or("+t.message+")",e},and:function(t){if(!yd(t))throw new TypeError("Matcher expected");var n=this,e=ud.create(xd);return e.test=function(e){return n.test(e)&&t.test(e)},e.message=n.message+".and("+t.message+")",e}},(Ad=function(t,e){var n=ud.create(xd);switch(ud.typeOf(t)){case"object":if("function"==typeof t.test)return n.test=function(e){return!0===t.test(e)},n.message="match("+ud.functionName(t.test)+")",n;var r=[];for(var i in t)t.hasOwnProperty(i)&&r.push(i+": "+t[i]);n.test=function(e){return function e(t,n){if(null==n)return!1;for(var r in t)if(t.hasOwnProperty(r)){var i=t[r],o=n[r];if(Ad.isMatcher(i)){if(!i.test(o))return!1}else if("object"===ud.typeOf(i)){if(!e(i,o))return!1}else if(!ud.deepEqual(i,o))return!1}return!0}(t,e)},n.message="match("+r.join(", ")+")";break;case"number":n.test=function(e){return t==e};break;case"string":n.test=function(e){return"string"==typeof e&&-1!==e.indexOf(t)},n.message='match("'+t+'")';break;case"regexp":n.test=function(e){return"string"==typeof e&&t.test(e)};break;case"function":n.test=t,n.message=e||"match("+ud.functionName(t)+")";break;default:n.test=function(e){return ud.deepEqual(t,e)}}return n.message||(n.message="match("+t+")"),n}).isMatcher=yd,Ad.any=Ad(function(){return!0},"any"),Ad.defined=Ad(function(e){return null!=e},"defined"),Ad.truthy=Ad(function(e){return!!e},"truthy"),Ad.falsy=Ad(function(e){return!e},"falsy"),Ad.same=function(t){return Ad(function(e){return t===e},"same("+t+")")},Ad.typeOf=function(t){return wd(t,"string","type"),Ad(function(e){return ud.typeOf(e)===t},'typeOf("'+t+'")')},Ad.instanceOf=function(t){return wd(t,"function","type"),Ad(function(e){return e instanceof t},"instanceOf("+ud.functionName(t)+")")},Ad.has=Bd(function(e,t){return"object"==typeof e?t in e:void 0!==e[t]},"has"),Ad.hasOwn=Bd(function(e,t){return e.hasOwnProperty(t)},"hasOwn"),Ad.bool=Ad.typeOf("boolean"),Ad.number=Ad.typeOf("number"),Ad.string=Ad.typeOf("string"),Ad.object=Ad.typeOf("object"),Ad.func=Ad.typeOf("function"),Ad.array=Ad.typeOf("array"),Ad.regexp=Ad.typeOf("regexp"),Ad.date=Ad.typeOf("date"),vd?module.exports=Ad:ud.match=Ad),ye="object"==typeof sinon&&sinon||null,ze="undefined"!=typeof module&&module.exports,!ye&&ze&&(ye=require("../sinon")),ye&&(Be=Array.prototype.slice,(Ce={calledOn:function(e){return ye.match&&ye.match.isMatcher(e)?e.test(this.thisValue):this.thisValue===e},calledWith:function(){for(var e=0,t=arguments.length;e<t;e+=1)if(!ye.deepEqual(arguments[e],this.args[e]))return!1;return!0},calledWithMatch:function(){for(var e=0,t=arguments.length;e<t;e+=1){var n=this.args[e],r=arguments[e];if(!ye.match||!ye.match(r).test(n))return!1}return!0},calledWithExactly:function(){return arguments.length==this.args.length&&this.calledWith.apply(this,arguments)},notCalledWith:function(){return!this.calledWith.apply(this,arguments)},notCalledWithMatch:function(){return!this.calledWithMatch.apply(this,arguments)},returned:function(e){return ye.deepEqual(e,this.returnValue)},threw:function(e){return void 0!==e&&this.exception?this.exception===e||this.exception.name===e:!!this.exception},calledWithNew:function(){return this.proxy.prototype&&this.thisValue instanceof this.proxy},calledBefore:function(e){return this.callId<e.callId},calledAfter:function(e){return this.callId>e.callId},callArg:function(e){this.args[e]()},callArgOn:function(e,t){this.args[e].apply(t)},callArgWith:function(e){this.callArgOnWith.apply(this,[e,null].concat(Be.call(arguments,1)))},callArgOnWith:function(e,t){var n=Be.call(arguments,2);this.args[e].apply(t,n)},yield:function(){this.yieldOn.apply(this,[null].concat(Be.call(arguments,0)))},yieldOn:function(e){for(var t=this.args,n=0,r=t.length;n<r;++n)if("function"==typeof t[n])return void t[n].apply(e,Be.call(arguments,1));Ae(this.proxy," cannot yield since no callback was passed.",t)},yieldTo:function(e){this.yieldToOn.apply(this,[e,null].concat(Be.call(arguments,1)))},yieldToOn:function(e,t){for(var n=this.args,r=0,i=n.length;r<i;++r)if(n[r]&&"function"==typeof n[r][e])return void n[r][e].apply(t,Be.call(arguments,2));Ae(this.proxy," cannot yield to '"+e+"' since no callback was passed.",n)},toString:function(){for(var e=this.proxy.toString()+"(",t=[],n=0,r=this.args.length;n<r;++n)t.push(ye.format(this.args[n]));return e=e+t.join(", ")+")",void 0!==this.returnValue&&(e+=" => "+ye.format(this.returnValue)),this.exception&&(e+=" !"+this.exception.name,this.exception.message&&(e+="("+this.exception.message+")")),e}}).invokeCallback=Ce.yield,De.toString=Ce.toString,ze?module.exports=De:ye.spyCall=De),function(sinon){var commonJSModule="undefined"!=typeof module&&module.exports,push=Array.prototype.push,slice=Array.prototype.slice,callId=0,vars,uuid,spyApi;function spy(e,t){if(!t&&"function"==typeof e)return spy.create(e);if(!e&&!t)return spy.create(function(){});var n=e[t];return sinon.wrapMethod(e,t,spy.create(n))}function matchingFake(e,t,n){if(e)for(var r=0,i=e.length;r<i;r++)if(e[r].matches(t,n))return e[r]}function incrementCallCount(){this.called=!0,this.callCount+=1,this.notCalled=!1,this.calledOnce=1==this.callCount,this.calledTwice=2==this.callCount,this.calledThrice=3==this.callCount}function createCallProperties(){this.firstCall=this.getCall(0),this.secondCall=this.getCall(1),this.thirdCall=this.getCall(2),this.lastCall=this.getCall(this.callCount-1)}function createProxy(func){var p;return func.length?eval("p = (function proxy("+vars.substring(0,2*func.length-1)+") { return p.invoke(func, this, slice.call(arguments)); });"):p=function(){return p.invoke(func,this,slice.call(arguments))},p}function delegateToCalls(i,o,s,a){spyApi[i]=function(){if(!this.called)return!!a&&a.apply(this,arguments);for(var e,t=0,n=0,r=this.callCount;n<r;n+=1)if((e=this.getCall(n))[s||i].apply(e,arguments)&&(t+=1,o))return!0;return t===this.callCount}}!sinon&&commonJSModule&&(sinon=require("../sinon")),sinon&&(vars="a,b,c,d,e,f,g,h,i,j,k,l",uuid=0,spyApi={reset:function(){if(this.called=!1,this.notCalled=!0,this.calledOnce=!1,this.calledTwice=!1,this.calledThrice=!1,this.callCount=0,this.firstCall=null,this.secondCall=null,this.thirdCall=null,this.lastCall=null,this.args=[],this.returnValues=[],this.thisValues=[],this.exceptions=[],this.callIds=[],this.fakes)for(var e=0;e<this.fakes.length;e++)this.fakes[e].reset()},create:function(e){var t;"function"!=typeof e?e=function(){}:t=sinon.functionName(e);var n=createProxy(e);return sinon.extend(n,spy),delete n.create,sinon.extend(n,e),n.reset(),n.prototype=e.prototype,n.displayName=t||"spy",n.toString=sinon.functionToString,n._create=sinon.spy.create,n.id="spy#"+uuid++,n},invoke:function(e,t,n){var r,i=matchingFake(this.fakes,n);incrementCallCount.call(this),push.call(this.thisValues,t),push.call(this.args,n),push.call(this.callIds,callId++);try{var o=i?i.invoke(e,t,n):(this.func||e).apply(t,n);this.getCall(this.callCount-1).calledWithNew()&&"object"!=typeof o&&(o=t)}catch(e){r=e}if(push.call(this.exceptions,r),push.call(this.returnValues,o),createCallProperties.call(this),void 0!==r)throw r;return o},getCall:function(e){return e<0||e>=this.callCount?null:sinon.spyCall(this,this.thisValues[e],this.args[e],this.returnValues[e],this.exceptions[e],this.callIds[e])},getCalls:function(){for(var e=[],t=0;t<this.callCount;t++)e.push(this.getCall(t));return e},calledBefore:function(e){return!!this.called&&(!e.called||this.callIds[0]<e.callIds[e.callIds.length-1])},calledAfter:function(e){return!(!this.called||!e.called)&&this.callIds[this.callCount-1]>e.callIds[e.callCount-1]},withArgs:function(){var e=slice.call(arguments);if(this.fakes){var t=matchingFake(this.fakes,e,!0);if(t)return t}else this.fakes=[];var n=this,r=this._create();r.matchingAguments=e,r.parent=this,push.call(this.fakes,r),r.withArgs=function(){return n.withArgs.apply(n,arguments)};for(var i=0;i<this.args.length;i++)r.matches(this.args[i])&&(incrementCallCount.call(r),push.call(r.thisValues,this.thisValues[i]),push.call(r.args,this.args[i]),push.call(r.returnValues,this.returnValues[i]),push.call(r.exceptions,this.exceptions[i]),push.call(r.callIds,this.callIds[i]));return createCallProperties.call(r),r},matches:function(e,t){var n=this.matchingAguments;if(n.length<=e.length&&sinon.deepEqual(n,e.slice(0,n.length)))return!t||n.length==e.length},printf:function(e){var n,r=this,i=slice.call(arguments,1);return(e||"").replace(/%(.)/g,function(e,t){return"function"==typeof(n=spyApi.formatters[t])?n.call(null,r,i):isNaN(parseInt(t,10))?"%"+t:sinon.format(i[t-1])})}},delegateToCalls("calledOn",!0),delegateToCalls("alwaysCalledOn",!1,"calledOn"),delegateToCalls("calledWith",!0),delegateToCalls("calledWithMatch",!0),delegateToCalls("alwaysCalledWith",!1,"calledWith"),delegateToCalls("alwaysCalledWithMatch",!1,"calledWithMatch"),delegateToCalls("calledWithExactly",!0),delegateToCalls("alwaysCalledWithExactly",!1,"calledWithExactly"),delegateToCalls("neverCalledWith",!1,"notCalledWith",function(){return!0}),delegateToCalls("neverCalledWithMatch",!1,"notCalledWithMatch",function(){return!0}),delegateToCalls("threw",!0),delegateToCalls("alwaysThrew",!1,"threw"),delegateToCalls("returned",!0),delegateToCalls("alwaysReturned",!1,"returned"),delegateToCalls("calledWithNew",!0),delegateToCalls("alwaysCalledWithNew",!1,"calledWithNew"),delegateToCalls("callArg",!1,"callArgWith",function(){throw new Error(this.toString()+" cannot call arg since it was not yet invoked.")}),spyApi.callArgWith=spyApi.callArg,delegateToCalls("callArgOn",!1,"callArgOnWith",function(){throw new Error(this.toString()+" cannot call arg since it was not yet invoked.")}),spyApi.callArgOnWith=spyApi.callArgOn,delegateToCalls("yield",!1,"yield",function(){throw new Error(this.toString()+" cannot yield since it was not yet invoked.")}),spyApi.invokeCallback=spyApi.yield,delegateToCalls("yieldOn",!1,"yieldOn",function(){throw new Error(this.toString()+" cannot yield since it was not yet invoked.")}),delegateToCalls("yieldTo",!1,"yieldTo",function(e){throw new Error(this.toString()+" cannot yield to '"+e+"' since it was not yet invoked.")}),delegateToCalls("yieldToOn",!1,"yieldToOn",function(e){throw new Error(this.toString()+" cannot yield to '"+e+"' since it was not yet invoked.")}),spyApi.formatters={c:function(e){return sinon.timesInWords(e.callCount)},n:function(e){return e.toString()},C:function(e){for(var t=[],n=0,r=e.callCount;n<r;++n){var i="    "+e.getCall(n).toString();/\n/.test(t[n-1])&&(i="\n"+i),push.call(t,i)}return 0<t.length?"\n"+t.join("\n"):""},t:function(e){for(var t=[],n=0,r=e.callCount;n<r;++n)push.call(t,sinon.format(e.thisValues[n]));return t.join(", ")},"*":function(e,t){for(var n=[],r=0,i=t.length;r<i;++r)push.call(n,sinon.format(t[r]));return n.join(", ")}},sinon.extend(spy,spyApi),spy.spyCall=sinon.spyCall,commonJSModule?module.exports=spy:sinon.spy=spy)}("object"==typeof sinon&&sinon||null),function(i){var e="undefined"!=typeof module&&module.exports;if(!i&&e&&(i=require("../sinon")),i){var n=Array.prototype.slice,o=Array.prototype.join,r="object"==typeof process&&"function"==typeof process.nextTick?process.nextTick:"function"==typeof setImmediate?setImmediate:function(e){setTimeout(e,0)},t={create:function(e){var t=i.extend({},i.behavior);return delete t.create,t.stub=e,t},isPresent:function(){return"number"==typeof this.callArgAt||this.exception||"number"==typeof this.returnArgAt||this.returnThis||this.returnValueDefined},invoke:function(e,t){if(l(this,t),this.exception)throw this.exception;return"number"==typeof this.returnArgAt?t[this.returnArgAt]:this.returnThis?e:this.returnValue},onCall:function(e){return this.stub.onCall(e)},onFirstCall:function(){return this.stub.onFirstCall()},onSecondCall:function(){return this.stub.onSecondCall()},onThirdCall:function(){return this.stub.onThirdCall()},withArgs:function(){throw new Error('Defining a stub by invoking "stub.onCall(...).withArgs(...)" is not supported. Use "stub.withArgs(...).onCall(...)" to define sequential behavior for calls with certain arguments.')},callsArg:function(e){if("number"!=typeof e)throw new TypeError("argument index is not number");return this.callArgAt=e,this.callbackArguments=[],this.callbackContext=void 0,this.callArgProp=void 0,this.callbackAsync=!1,this},callsArgOn:function(e,t){if("number"!=typeof e)throw new TypeError("argument index is not number");if("object"!=typeof t)throw new TypeError("argument context is not an object");return this.callArgAt=e,this.callbackArguments=[],this.callbackContext=t,this.callArgProp=void 0,this.callbackAsync=!1,this},callsArgWith:function(e){if("number"!=typeof e)throw new TypeError("argument index is not number");return this.callArgAt=e,this.callbackArguments=n.call(arguments,1),this.callbackContext=void 0,this.callArgProp=void 0,this.callbackAsync=!1,this},callsArgOnWith:function(e,t){if("number"!=typeof e)throw new TypeError("argument index is not number");if("object"!=typeof t)throw new TypeError("argument context is not an object");return this.callArgAt=e,this.callbackArguments=n.call(arguments,2),this.callbackContext=t,this.callArgProp=void 0,this.callbackAsync=!1,this},yields:function(){return this.callArgAt=-1,this.callbackArguments=n.call(arguments,0),this.callbackContext=void 0,this.callArgProp=void 0,this.callbackAsync=!1,this},yieldsOn:function(e){if("object"!=typeof e)throw new TypeError("argument context is not an object");return this.callArgAt=-1,this.callbackArguments=n.call(arguments,1),this.callbackContext=e,this.callArgProp=void 0,this.callbackAsync=!1,this},yieldsTo:function(e){return this.callArgAt=-1,this.callbackArguments=n.call(arguments,1),this.callbackContext=void 0,this.callArgProp=e,this.callbackAsync=!1,this},yieldsToOn:function(e,t){if("object"!=typeof t)throw new TypeError("argument context is not an object");return this.callArgAt=-1,this.callbackArguments=n.call(arguments,2),this.callbackContext=t,this.callArgProp=e,this.callbackAsync=!1,this},throws:a,throwsException:a,returns:function(e){return this.returnValue=e,this.returnValueDefined=!0,this},returnsArg:function(e){if("number"!=typeof e)throw new TypeError("argument index is not number");return this.returnArgAt=e,this},returnsThis:function(){return this.returnThis=!0,this}};for(var s in t)t.hasOwnProperty(s)&&s.match(/^(callsArg|yields)/)&&!s.match(/Async/)&&(t[s+"Async"]=function(t){return function(){var e=this[t].apply(this,arguments);return this.callbackAsync=!0,e}}(s));e?module.exports=t:i.behavior=t}function a(e,t){return"string"==typeof e?(this.exception=new Error(t||""),this.exception.name=e):this.exception=e||new Error("Error"),this}function l(e,t){if("number"==typeof e.callArgAt){var n=function(e,t){var n=e.callArgAt;if(n<0){for(var r=e.callArgProp,i=0,o=t.length;i<o;++i){if(!r&&"function"==typeof t[i])return t[i];if(r&&t[i]&&"function"==typeof t[i][r])return t[i][r]}return null}return t[n]}(e,t);if("function"!=typeof n)throw new TypeError(function(e,t,n){if(e.callArgAt<0){var r=e.callArgProp?i.functionName(e.stub)+" expected to yield to '"+e.callArgProp+"', but no object with such a property was passed.":i.functionName(e.stub)+" expected to yield, but no callback was passed.";return 0<n.length&&(r+=" Received ["+o.call(n,", ")+"]"),r}return"argument at index "+e.callArgAt+" is not a function: "+t}(e,n,t));e.callbackAsync?r(function(){n.apply(e.callbackContext,e.callbackArguments)}):n.apply(e.callbackContext,e.callbackArguments)}}}("object"==typeof sinon&&sinon||null),Th="object"==typeof sinon&&sinon||null,Uh="undefined"!=typeof module&&module.exports,!Th&&Uh&&(Th=require("../sinon")),Th&&(Zh=0,Th.extend(Vh,function(){var e={create:function(){var e=function(){return Yh(e).invoke(this,arguments)};e.id="stub#"+Zh++;var t=e;return(e=Th.spy.create(e)).func=t,Th.extend(e,Vh),e._create=Th.stub.create,e.displayName="stub",e.toString=Th.functionToString,e.defaultBehavior=null,e.behaviors=[],e},resetBehavior:function(){var e;if(this.defaultBehavior=null,this.behaviors=[],delete this.returnValue,delete this.returnArgAt,this.returnThis=!1,this.fakes)for(e=0;e<this.fakes.length;e++)this.fakes[e].resetBehavior()},onCall:function(e){return this.behaviors[e]||(this.behaviors[e]=Th.behavior.create(this)),this.behaviors[e]},onFirstCall:function(){return this.onCall(0)},onSecondCall:function(){return this.onCall(1)},onThirdCall:function(){return this.onCall(2)}};for(var t in Th.behavior)Th.behavior.hasOwnProperty(t)&&!e.hasOwnProperty(t)&&"create"!=t&&"withArgs"!=t&&"invoke"!=t&&(e[t]=function(e){return function(){return this.defaultBehavior=this.defaultBehavior||Th.behavior.create(this),this.defaultBehavior[e].apply(this.defaultBehavior,arguments),this}}(t));return e}()),Uh?module.exports=Vh:Th.stub=Vh),pi="object"==typeof sinon&&sinon||null,qi="undefined"!=typeof module&&module.exports,ri=[].push,!pi&&qi&&(pi=require("../sinon")),pi&&(!(si=pi.match)&&qi&&(si=require("./match")),pi.mock=ti,pi.extend(ti,{create:function(e){if(!e)throw new TypeError("object is null");var t=pi.extend({},ti);return t.object=e,delete t.create,t},expects:function(e){if(!e)throw new TypeError("method is falsy");var t;this.expectations||(this.expectations={},this.proxies=[]),this.expectations[e]||(this.expectations[e]=[],t=this,pi.wrapMethod(this.object,e,function(){return t.invokeMethod(e,this,arguments)}),ri.call(this.proxies,e));var n=pi.expectation.create(e);return ri.call(this.expectations[e],n),n},restore:function(){var t=this.object;wi(this.proxies,function(e){"function"==typeof t[e].restore&&t[e].restore()})},verify:function(){var t=this.expectations||{},n=[],r=[];return wi(this.proxies,function(e){wi(t[e],function(e){e.met()?ri.call(r,e.toString()):ri.call(n,e.toString())})}),this.restore(),0<n.length?pi.expectation.fail(n.concat(r).join("\n")):pi.expectation.pass(n.concat(r).join("\n")),!0},invokeMethod:function(e,t,n){for(var r=this.expectations&&this.expectations[e],i=r&&r.length||0,o=0;o<i;o+=1)if(!r[o].met()&&r[o].allowsCall(t,n))return r[o].apply(t,n);var s,a=[],l=0;for(o=0;o<i;o+=1)r[o].allowsCall(t,n)?s=s||r[o]:l+=1,ri.call(a,"    "+r[o].toString());if(0===l)return s.apply(t,n);a.unshift("Unexpected call: "+pi.spyCall.toString.call({proxy:e,args:n})),pi.expectation.fail(a.join("\n"))}}),ui=pi.timesInWords,pi.expectation=(_i=Array.prototype.slice,aj=pi.spy.invoke,{minCalls:1,maxCalls:1,create:function(e){var t=pi.extend(pi.stub.create(),pi.expectation);return delete t.create,t.method=e,t},invoke:function(e,t,n){return this.verifyCallAllowed(t,n),aj.apply(this,arguments)},atLeast:function(e){if("number"!=typeof e)throw new TypeError("'"+e+"' is not number");return this.limitsSet||(this.maxCalls=null,this.limitsSet=!0),this.minCalls=e,this},atMost:function(e){if("number"!=typeof e)throw new TypeError("'"+e+"' is not number");return this.limitsSet||(this.minCalls=null,this.limitsSet=!0),this.maxCalls=e,this},never:function(){return this.exactly(0)},once:function(){return this.exactly(1)},twice:function(){return this.exactly(2)},thrice:function(){return this.exactly(3)},exactly:function(e){if("number"!=typeof e)throw new TypeError("'"+e+"' is not a number");return this.atLeast(e),this.atMost(e)},met:function(){return!this.failed&&(!("number"==typeof(e=this).minCalls)||e.callCount>=e.minCalls);var e},verifyCallAllowed:function(e,t){if(ej(this)&&(this.failed=!0,pi.expectation.fail(this.method+" already called "+ui(this.maxCalls))),"expectedThis"in this&&this.expectedThis!==e&&pi.expectation.fail(this.method+" called with "+e+" as thisValue, expected "+this.expectedThis),"expectedArguments"in this){t||pi.expectation.fail(this.method+" received no arguments, expected "+pi.format(this.expectedArguments)),t.length<this.expectedArguments.length&&pi.expectation.fail(this.method+" received too few arguments ("+pi.format(t)+"), expected "+pi.format(this.expectedArguments)),this.expectsExactArgCount&&t.length!=this.expectedArguments.length&&pi.expectation.fail(this.method+" received too many arguments ("+pi.format(t)+"), expected "+pi.format(this.expectedArguments));for(var n=0,r=this.expectedArguments.length;n<r;n+=1)fj(this.expectedArguments[n],t[n])||pi.expectation.fail(this.method+" received wrong arguments "+pi.format(t)+", didn't match "+this.expectedArguments.toString()),pi.deepEqual(this.expectedArguments[n],t[n])||pi.expectation.fail(this.method+" received wrong arguments "+pi.format(t)+", expected "+pi.format(this.expectedArguments))}},allowsCall:function(e,t){if(this.met()&&ej(this))return!1;if("expectedThis"in this&&this.expectedThis!==e)return!1;if(!("expectedArguments"in this))return!0;if((t=t||[]).length<this.expectedArguments.length)return!1;if(this.expectsExactArgCount&&t.length!=this.expectedArguments.length)return!1;for(var n=0,r=this.expectedArguments.length;n<r;n+=1){if(!fj(this.expectedArguments[n],t[n]))return!1;if(!pi.deepEqual(this.expectedArguments[n],t[n]))return!1}return!0},withArgs:function(){return this.expectedArguments=_i.call(arguments),this},withExactArgs:function(){return this.withArgs.apply(this,arguments),this.expectsExactArgCount=!0,this},on:function(e){return this.expectedThis=e,this},toString:function(){var e=(this.expectedArguments||[]).slice();this.expectsExactArgCount||ri.call(e,"[...]");var t,n=pi.spyCall.toString.call({proxy:this.method||"anonymous mock expectation",args:e}).replace(", [...","[, ...")+" "+function(e){var t=e.minCalls,n=e.maxCalls;if("number"!=typeof t||"number"!=typeof n)return"number"==typeof t?"at least "+ui(t):"at most "+ui(n);var r=ui(t);return t!=n&&(r="at least "+r+" and at most "+ui(n)),r}(this);return this.met()?"Expectation met: "+n:"Expected "+n+" ("+(0==(t=this.callCount)?"never called":"called "+ui(t))+")"},verify:function(){return this.met()?pi.expectation.pass(this.toString()):pi.expectation.fail(this.toString()),!0},pass:function(e){pi.assert.pass(e)},fail:function(e){var t=new Error(e);throw t.name="ExpectationError",t}}),qi?module.exports=ti:pi.mock=ti),bk="object"==typeof sinon&&sinon||null,ck="undefined"!=typeof module&&module.exports,dk=[].push,ek=Object.prototype.hasOwnProperty,!bk&&ck&&(bk=require("../sinon")),bk&&(ik={verify:function(){gk(this,"verify")},restore:function(){gk(this,"restore"),function(e){for(var t=fk(e);0<t.length;)t.splice(0,1)}(this)},verifyAndRestore:function(){var t;try{this.verify()}catch(e){t=e}if(this.restore(),t)throw t},add:function(e){return dk.call(fk(this),e),e},spy:function(){return this.add(bk.spy.apply(bk,arguments))},stub:function(e,t,n){if(t){var r=e[t];if("function"!=typeof r){if(!ek.call(e,t))throw new TypeError("Cannot stub non-existent own property "+t);return e[t]=n,this.add({restore:function(){e[t]=r}})}}if(t||!e||"object"!=typeof e)return this.add(bk.stub.apply(bk,arguments));var i=bk.stub.apply(bk,arguments);for(var o in i)"function"==typeof i[o]&&this.add(i[o]);return i},mock:function(){return this.add(bk.mock.apply(bk,arguments))},inject:function(e){var t=this;return e.spy=function(){return t.spy.apply(t,arguments)},e.stub=function(){return t.stub.apply(t,arguments)},e.mock=function(){return t.mock.apply(t,arguments)},e}},ck?module.exports=ik:bk.collection=ik),void 0===sinon&&(sinon={}),function(global){var id=1,El;function addTimer(e,t){if(0===e.length)throw new Error("Function requires at least 1 parameter");if(void 0===e[0])throw new Error("Callback must be provided to timer calls");var n=id++,r=e[1]||0;return this.timeouts||(this.timeouts={}),this.timeouts[n]={id:n,func:e[0],callAt:this.now+r,invokeArgs:Array.prototype.slice.call(e,2)},!0===t&&(this.timeouts[n].interval=r),n}function parseTime(e){if(!e)return 0;var t,n=e.split(":"),r=n.length,i=r,o=0;if(3<r||!/^(\d\d:){0,2}\d\d?$/.test(e))throw new Error("tick only understands numbers and 'h:m:s'");for(;i--;){if(60<=(t=parseInt(n[i],10)))throw new Error("Invalid time "+e);o+=t*Math.pow(60,r-i-1)}return 1e3*o}function createObject(e){var t,n=Object.create?Object.create(e):((t=function(){}).prototype=e,new t);return n.Date.clock=n}function mirrorDateProperties(e,t){for(var n in t.now?e.now=function(){return e.clock.now}:delete e.now,t.toSource?e.toSource=function(){return t.toSource()}:delete e.toSource,e.toString=function(){return t.toString()},e.prototype=t.prototype,e.parse=t.parse,e.UTC=t.UTC,e.prototype.toUTCString=t.prototype.toUTCString,t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}sinon.clock={now:0,create:function(e){var t=createObject(this);if("number"==typeof e&&(t.now=e),e&&"object"==typeof e)throw new TypeError("now should be milliseconds since UNIX epoch");return t},setTimeout:function(e,t){return addTimer.call(this,arguments,!1)},clearTimeout:function(e){this.timeouts||(this.timeouts=[]),e in this.timeouts&&delete this.timeouts[e]},setInterval:function(e,t){return addTimer.call(this,arguments,!0)},clearInterval:function(e){this.clearTimeout(e)},setImmediate:function(e){var t=Array.prototype.slice.call(arguments,1);return addTimer.call(this,[e,0].concat(t),!1)},clearImmediate:function(e){this.clearTimeout(e)},tick:function(e){e="number"==typeof e?e:parseTime(e);for(var t,n=this.now,r=this.now+e,i=this.now,o=this.firstTimerInRange(n,r);o&&n<=r;){if(this.timeouts[o.id]){n=this.now=o.callAt;try{this.callTimer(o)}catch(e){t=t||e}}o=this.firstTimerInRange(i,r),i=n}if(this.now=r,t)throw t;return this.now},firstTimerInRange:function(e,t){var n,r=null;for(var i in this.timeouts)if(this.timeouts.hasOwnProperty(i)){if(this.timeouts[i].callAt<e||this.timeouts[i].callAt>t)continue;(null===r||this.timeouts[i].callAt<r)&&(this.timeouts[i],r=this.timeouts[i].callAt,n={func:this.timeouts[i].func,callAt:this.timeouts[i].callAt,interval:this.timeouts[i].interval,id:this.timeouts[i].id,invokeArgs:this.timeouts[i].invokeArgs})}return n||null},callTimer:function(timer){"number"==typeof timer.interval?this.timeouts[timer.id].callAt+=timer.interval:delete this.timeouts[timer.id];try{"function"==typeof timer.func?timer.func.apply(null,timer.invokeArgs):eval(timer.func)}catch(e){var exception=e}if(this.timeouts[timer.id]){if(exception)throw exception}else if(exception)throw exception},reset:function(){this.timeouts={}},Date:(El=Date,mirrorDateProperties(function e(t,n,r,i,o,s,a){switch(arguments.length){case 0:return new El(e.clock.now);case 1:return new El(t);case 2:return new El(t,n);case 3:return new El(t,n,r);case 4:return new El(t,n,r,i);case 5:return new El(t,n,r,i,o);case 6:return new El(t,n,r,i,o,s);default:return new El(t,n,r,i,o,s,a)}},El))};var methods=["Date","setTimeout","setInterval","clearTimeout","clearInterval"];function restore(){for(var e,t=0,n=this.methods.length;t<n;t++)if(e=this.methods[t],global[e].hadOwnProperty)global[e]=this["_"+e];else try{delete global[e]}catch(e){}this.methods=[]}function stubGlobal(e,t){if(t[e].hadOwnProperty=Object.prototype.hasOwnProperty.call(global,e),t["_"+e]=global[e],"Date"==e){var n=mirrorDateProperties(t[e],global[e]);global[e]=n}else for(var r in global[e]=function(){return t[e].apply(t,arguments)},t[e])t[e].hasOwnProperty(r)&&(global[e][r]=t[e][r]);global[e].clock=t}void 0!==global.setImmediate&&methods.push("setImmediate"),void 0!==global.clearImmediate&&methods.push("clearImmediate"),sinon.useFakeTimers=function(e){var t=sinon.clock.create(e);t.restore=restore,t.methods=Array.prototype.slice.call(arguments,"number"==typeof e?1:0),0===t.methods.length&&(t.methods=methods);for(var n=0,r=t.methods.length;n<r;n++)stubGlobal(t.methods[n],t);return t}}("undefined"!=typeof global&&"function"!=typeof global?global:this),sinon.timers={setTimeout:setTimeout,clearTimeout:clearTimeout,setImmediate:"undefined"!=typeof setImmediate?setImmediate:void 0,clearImmediate:"undefined"!=typeof clearImmediate?clearImmediate:void 0,setInterval:setInterval,clearInterval:clearInterval,Date:Date},"undefined"!=typeof module&&module.exports&&(module.exports=sinon),void 0===sinon&&(this.sinon={}),em=[].push,sinon.Event=function(e,t,n,r){this.initEvent(e,t,n,r)},sinon.Event.prototype={initEvent:function(e,t,n,r){this.type=e,this.bubbles=t,this.cancelable=n,this.target=r},stopPropagation:function(){},preventDefault:function(){this.defaultPrevented=!0}},sinon.EventTarget={addEventListener:function(e,t){this.eventListeners=this.eventListeners||{},this.eventListeners[e]=this.eventListeners[e]||[],em.call(this.eventListeners[e],t)},removeEventListener:function(e,t){for(var n=this.eventListeners&&this.eventListeners[e]||[],r=0,i=n.length;r<i;++r)if(n[r]==t)return n.splice(r,1)},dispatchEvent:function(e){for(var t=e.type,n=this.eventListeners&&this.eventListeners[t]||[],r=0;r<n.length;r++)"function"==typeof n[r]?n[r].call(this,e):n[r].handleEvent(e);return!!e.defaultPrevented}},function(t){void 0===sinon&&(t.sinon={});var n="undefined"!=typeof ProgressEvent,r="undefined"!=typeof CustomEvent;sinon.xhr={XMLHttpRequest:t.XMLHttpRequest};var i=sinon.xhr;i.GlobalXMLHttpRequest=t.XMLHttpRequest,i.GlobalActiveXObject=t.ActiveXObject,i.supportsActiveX=void 0!==i.GlobalActiveXObject,i.supportsXHR=void 0!==i.GlobalXMLHttpRequest,i.workingXHR=i.supportsXHR?i.GlobalXMLHttpRequest:!!i.supportsActiveX&&function(){return new i.GlobalActiveXObject("MSXML2.XMLHTTP.3.0")},i.supportsCORS="withCredentials"in new sinon.xhr.GlobalXMLHttpRequest;var o={"Accept-Charset":!0,"Accept-Encoding":!0,Connection:!0,"Content-Length":!0,Cookie:!0,Cookie2:!0,"Content-Transfer-Encoding":!0,Date:!0,Expect:!0,Host:!0,"Keep-Alive":!0,Referer:!0,TE:!0,Trailer:!0,"Transfer-Encoding":!0,Upgrade:!0,"User-Agent":!0,Via:!0};function s(){this.readyState=s.UNSENT,this.requestHeaders={},this.requestBody=null,this.status=0,this.statusText="",this.upload=new a,sinon.xhr.supportsCORS&&(this.withCredentials=!1);var r=this,e=["loadstart","load","abort","loadend"];for(var t=e.length-1;0<=t;t--)!function(n){r.addEventListener(n,function(e){var t=r["on"+n];t&&"function"==typeof t&&t(e)})}(e[t]);"function"==typeof s.onCreate&&s.onCreate(this)}function a(){this.eventListeners={progress:[],load:[],abort:[],error:[]}}function l(e){if(e.readyState!==s.OPENED)throw new Error("INVALID_STATE_ERR");if(e.sendFlag)throw new Error("INVALID_STATE_ERR")}function c(e,t){if(e)for(var n=0,r=e.length;n<r;n+=1)t(e[n])}a.prototype.addEventListener=function(e,t){this.eventListeners[e].push(t)},a.prototype.removeEventListener=function(e,t){for(var n=this.eventListeners[e]||[],r=0,i=n.length;r<i;++r)if(n[r]==t)return n.splice(r,1)},a.prototype.dispatchEvent=function(e){for(var t,n=this.eventListeners[e.type]||[],r=0;null!=(t=n[r]);r++)t(e)};function u(e,t,n){switch(n.length){case 0:return e[t]();case 1:return e[t](n[0]);case 2:return e[t](n[0],n[1]);case 3:return e[t](n[0],n[1],n[2]);case 4:return e[t](n[0],n[1],n[2],n[3]);case 5:return e[t](n[0],n[1],n[2],n[3],n[4])}}s.filters=[],s.addFilter=function(e){this.filters.push(e)};var h=/MSIE 6/;s.defake=function(t,e){var n=new sinon.xhr.workingXHR;c(["open","setRequestHeader","send","abort","getResponseHeader","getAllResponseHeaders","addEventListener","overrideMimeType","removeEventListener"],function(e){t[e]=function(){return u(n,e,arguments)}});function r(e){c(e,function(e){try{t[e]=n[e]}catch(e){if(!h.test(navigator.userAgent))throw e}})}function i(){t.readyState=n.readyState,n.readyState>=s.HEADERS_RECEIVED&&r(["status","statusText"]),n.readyState>=s.LOADING&&r(["responseText"]),n.readyState===s.DONE&&r(["responseXML"]),t.onreadystatechange&&t.onreadystatechange.call(t,{target:t})}if(n.addEventListener){for(var o in t.eventListeners)t.eventListeners.hasOwnProperty(o)&&c(t.eventListeners[o],function(e){n.addEventListener(o,e)});n.addEventListener("readystatechange",i)}else n.onreadystatechange=i;u(n,"open",e)},s.useFilters=!1,sinon.extend(s.prototype,sinon.EventTarget,{async:!0,open:function(e,t,n,r,i){if(this.method=e,this.url=t,this.async="boolean"!=typeof n||n,this.username=r,this.password=i,this.responseText=null,this.responseXML=null,this.requestHeaders={},!(this.sendFlag=!1)===sinon.FakeXMLHttpRequest.useFilters){var o=arguments;if(function(e,t){for(var n=0;n<e.length;n++)if(!0===t(e[n]))return!0;return!1}(s.filters,function(e){return e.apply(this,o)}))return sinon.FakeXMLHttpRequest.defake(this,arguments)}this.readyStateChange(s.OPENED)},readyStateChange:function(e){if(this.readyState=e,"function"==typeof this.onreadystatechange)try{this.onreadystatechange()}catch(e){sinon.logError("Fake XHR onreadystatechange handler",e)}switch(this.dispatchEvent(new sinon.Event("readystatechange")),this.readyState){case s.DONE:this.dispatchEvent(new sinon.Event("load",!1,!1,this)),this.dispatchEvent(new sinon.Event("loadend",!1,!1,this)),this.upload.dispatchEvent(new sinon.Event("load",!1,!1,this)),n&&this.upload.dispatchEvent(new ProgressEvent("progress",{loaded:100,total:100}))}},setRequestHeader:function(e,t){if(l(this),o[e]||/^(Sec-|Proxy-)/.test(e))throw new Error('Refused to set unsafe header "'+e+'"');this.requestHeaders[e]?this.requestHeaders[e]+=","+t:this.requestHeaders[e]=t},setResponseHeaders:function(e){for(var t in this.responseHeaders={},e)e.hasOwnProperty(t)&&(this.responseHeaders[t]=e[t]);this.async?this.readyStateChange(s.HEADERS_RECEIVED):this.readyState=s.HEADERS_RECEIVED},send:function(e){var t;l(this),/^(get|head)$/i.test(this.method)||(this.requestHeaders["Content-Type"]?(t=this.requestHeaders["Content-Type"].split(";"),this.requestHeaders["Content-Type"]=t[0]+";charset=utf-8"):this.requestHeaders["Content-Type"]="text/plain;charset=utf-8",this.requestBody=e),this.errorFlag=!1,this.sendFlag=this.async,this.readyStateChange(s.OPENED),"function"==typeof this.onSend&&this.onSend(this),this.dispatchEvent(new sinon.Event("loadstart",!1,!1,this))},abort:function(){this.aborted=!0,this.responseText=null,this.errorFlag=!0,this.requestHeaders={},this.readyState>sinon.FakeXMLHttpRequest.UNSENT&&this.sendFlag&&(this.readyStateChange(sinon.FakeXMLHttpRequest.DONE),this.sendFlag=!1),this.readyState=sinon.FakeXMLHttpRequest.UNSENT,this.dispatchEvent(new sinon.Event("abort",!1,!1,this)),this.upload.dispatchEvent(new sinon.Event("abort",!1,!1,this)),"function"==typeof this.onerror&&this.onerror()},getResponseHeader:function(e){if(this.readyState<s.HEADERS_RECEIVED)return null;if(/^Set-Cookie2?$/i.test(e))return null;for(var t in e=e.toLowerCase(),this.responseHeaders)if(t.toLowerCase()==e)return this.responseHeaders[t];return null},getAllResponseHeaders:function(){if(this.readyState<s.HEADERS_RECEIVED)return"";var e="";for(var t in this.responseHeaders)this.responseHeaders.hasOwnProperty(t)&&!/^Set-Cookie2?$/i.test(t)&&(e+=t+": "+this.responseHeaders[t]+"\r\n");return e},setResponseBody:function(e){!function(e){if(e.readyState==s.DONE)throw new Error("Request done")}(this),function(e){if(e.async&&e.readyState!=s.HEADERS_RECEIVED)throw new Error("No headers received")}(this),function(e){if("string"!=typeof e){var t=new Error("Attempted to respond to fake XMLHttpRequest with "+e+", which is not a string.");throw t.name="InvalidBodyException",t}}(e);var t=this.chunkSize||10,n=0;for(this.responseText="";this.async&&this.readyStateChange(s.LOADING),this.responseText+=e.substring(n,n+t),(n+=t)<e.length;);var r=this.getResponseHeader("Content-Type");if(this.responseText&&(!r||/(text\/xml)|(application\/xml)|(\+xml)/.test(r)))try{this.responseXML=s.parseXML(this.responseText)}catch(e){}this.async?this.readyStateChange(s.DONE):this.readyState=s.DONE},respond:function(e,t,n){this.status="number"==typeof e?e:200,this.statusText=s.statusCodes[this.status],this.setResponseHeaders(t||{}),this.setResponseBody(n||"")},uploadProgress:function(e){n&&this.upload.dispatchEvent(new ProgressEvent("progress",e))},uploadError:function(e){r&&this.upload.dispatchEvent(new CustomEvent("error",{detail:e}))}}),sinon.extend(s,{UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4}),s.parseXML=function(e){var t;return"undefined"!=typeof DOMParser?t=(new DOMParser).parseFromString(e,"text/xml"):((t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e)),t},s.statusCodes={100:"Continue",101:"Switching Protocols",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",300:"Multiple Choice",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported"},sinon.useFakeXMLHttpRequest=function(){return sinon.FakeXMLHttpRequest.restore=function(e){i.supportsXHR&&(t.XMLHttpRequest=i.GlobalXMLHttpRequest),i.supportsActiveX&&(t.ActiveXObject=i.GlobalActiveXObject),delete sinon.FakeXMLHttpRequest.restore,!0!==e&&delete sinon.FakeXMLHttpRequest.onCreate},i.supportsXHR&&(t.XMLHttpRequest=sinon.FakeXMLHttpRequest),i.supportsActiveX&&(t.ActiveXObject=function(e){return"Microsoft.XMLHTTP"==e||/^Msxml2\.XMLHTTP/i.test(e)?new sinon.FakeXMLHttpRequest:new i.GlobalActiveXObject(e)}),sinon.FakeXMLHttpRequest},sinon.FakeXMLHttpRequest=s}("object"==typeof global?global:this),"undefined"!=typeof module&&module.exports&&(module.exports=sinon),void 0===sinon&&(sinon={}),sinon.fakeServer=(Go=[].push,Ko="undefined"!=typeof window?window.location:{},Lo=new RegExp("^"+Ko.protocol+"//"+Ko.host),{create:function(){var t=(Ho.prototype=this,new Ho);return this.xhr=sinon.useFakeXMLHttpRequest(),t.requests=[],this.xhr.onCreate=function(e){t.addRequest(e)},t},addRequest:function(e){var t=this;Go.call(this.requests,e),e.onSend=function(){t.handleRequest(this),t.autoRespond&&!t.responding&&(setTimeout(function(){t.responding=!1,t.respond()},t.autoRespondAfter||10),t.responding=!0)}},getHTTPMethod:function(e){if(this.fakeHTTPMethods&&/post/i.test(e.method)){var t=(e.requestBody||"").match(/_method=([^\b;]+)/);return t?t[1]:e.method}return e.method},handleRequest:function(e){e.async?(this.queue||(this.queue=[]),Go.call(this.queue,e)):this.processRequest(e)},respondWith:function(e,t,n){1!=arguments.length||"function"==typeof e?(this.responses||(this.responses=[]),1==arguments.length&&(n=e,t=e=null),2==arguments.length&&(n=t,t=e,e=null),Go.call(this.responses,{method:e,url:t,response:"function"==typeof n?n:Jo(n)})):this.response=Jo(e)},respond:function(){0<arguments.length&&this.respondWith.apply(this,arguments);for(var e,t=(this.queue||[]).splice(0);e=t.shift();)this.processRequest(e)},processRequest:function(e){try{if(e.aborted)return;var t=this.response||[404,{},""];if(this.responses)for(var n=this.responses.length-1;0<=n;n--)if(No.call(this,this.responses[n],e)){t=this.responses[n].response;break}4!=e.readyState&&(r=t,i=e,o="Request:\n"+sinon.format(i)+"\n\n",o+="Response:\n"+sinon.format(r)+"\n\n",sinon.log(o),e.respond(t[0],t[1],t[2]))}catch(e){sinon.logError("Fake server request processing",e)}var r,i,o},restore:function(){return this.xhr.restore&&this.xhr.restore.apply(this.xhr,arguments)}}),"undefined"!=typeof module&&module.exports&&(module.exports=sinon),Ep.prototype=sinon.fakeServer,sinon.fakeServerWithClock=new Ep,sinon.fakeServerWithClock.addRequest=function(e){var n,r,i;return e.async&&("object"==typeof setTimeout.clock?this.clock=setTimeout.clock:(this.clock=sinon.useFakeTimers(),this.resetClock=!0),this.longestTimeout||(n=this.clock.setTimeout,r=this.clock.setInterval,(i=this).clock.setTimeout=function(e,t){return i.longestTimeout=Math.max(t,i.longestTimeout||0),n.apply(this,arguments)},this.clock.setInterval=function(e,t){return i.longestTimeout=Math.max(t,i.longestTimeout||0),r.apply(this,arguments)})),sinon.fakeServer.addRequest.call(this,e)},sinon.fakeServerWithClock.respond=function(){var e=sinon.fakeServer.respond.apply(this,arguments);return this.clock&&(this.clock.tick(this.longestTimeout||0),this.longestTimeout=0,this.resetClock&&(this.clock.restore(),this.resetClock=!1)),e},sinon.fakeServerWithClock.restore=function(){return this.clock&&this.clock.restore(),sinon.fakeServer.restore.apply(this,arguments)},"undefined"!=typeof module&&module.exports&&(sinon=require("../sinon"),sinon.extend(sinon,require("./util/fake_timers"))),Rp=[].push,sinon.sandbox=sinon.extend(sinon.create(sinon.collection),{useFakeTimers:function(){return this.clock=sinon.useFakeTimers.apply(sinon,arguments),this.add(this.clock)},serverPrototype:sinon.fakeServer,useFakeServer:function(){var e=this.serverPrototype||sinon.fakeServer;return e&&e.create?(this.server=e.create(),this.add(this.server)):null},inject:function(e){return sinon.collection.inject.call(this,e),this.clock&&(e.clock=this.clock),this.server&&(e.server=this.server,e.requests=this.server.requests),e},create:function(e){if(!e)return sinon.create(sinon.sandbox);var t,n,r=(t=e,n=sinon.create(sinon.sandbox),t.useFakeServer&&("object"==typeof t.useFakeServer&&(n.serverPrototype=t.useFakeServer),n.useFakeServer()),t.useFakeTimers&&("object"==typeof t.useFakeTimers?n.useFakeTimers.apply(n,t.useFakeTimers):n.useFakeTimers()),n);r.args=r.args||[];var i,o,s=r.inject({});if(e.properties)for(var a=0,l=e.properties.length;a<l;a++)Sp(r,e,i=e.properties[a],o=s[i]||"sandbox"==i&&r);else Sp(r,e,"sandbox",o);return r}}),sinon.sandbox.useFakeXMLHttpRequest=sinon.sandbox.useFakeServer,"undefined"!=typeof module&&module.exports&&(module.exports=sinon.sandbox),jq="object"==typeof sinon&&sinon||null,kq="undefined"!=typeof module&&module.exports,!jq&&kq&&(jq=require("../sinon")),jq&&(lq.config={injectIntoThis:!0,injectInto:null,properties:["spy","stub","mock","clock","server","requests"],useFakeTimers:!0,useFakeServer:!0},kq?module.exports=lq:jq.test=lq),uq="object"==typeof sinon&&sinon||null,vq="undefined"!=typeof module&&module.exports,!uq&&vq&&(uq=require("../sinon")),uq&&Object.prototype.hasOwnProperty&&(vq?module.exports=xq:uq.testCase=xq),Nq="object"==typeof sinon&&sinon||null,Oq="undefined"!=typeof window?window:"undefined"!=typeof self?self:global,Pq="undefined"!=typeof module&&module.exports,Qq=Array.prototype.slice,!Nq&&Pq&&(Nq=require("../sinon")),Nq&&(Rq={failException:"AssertError",fail:function(e){var t=new Error(e);throw t.name=this.failException||Rq.failException,t},pass:function(){},callOrder:function(){Sq.apply(null,arguments);var e="",t="";if(Nq.calledInOrder(arguments))Rq.pass("callOrder");else{try{e=[].join.call(arguments,", ");for(var n=Qq.call(arguments),r=n.length;r;)n[--r].called||n.splice(r,1);t=Nq.orderByFirstCall(n).join(", ")}catch(e){}Tq(this,"expected "+e+" to be called in order but were called as "+t)}},callCount:function(e,t){var n;Sq(e),e.callCount!=t?(n="expected %n to be called "+Nq.timesInWords(t)+" but was called %c%C",Tq(this,e.printf(n))):Rq.pass("callCount")},expose:function(e,t){if(!e)throw new TypeError("target is null or undefined");var n,r,i=t||{},o=void 0===i.prefix?"assert":i.prefix,s=void 0===i.includeFail||!!i.includeFail;for(var a in this)"export"==a||!s&&/^(fail)/.test(a)||(e[r=a,!(n=o)||/^fail/.test(r)?r:n+r.slice(0,1).toUpperCase()+r.slice(1)]=this[a]);return e}},Uq("called","expected %n to have been called at least once but was never called"),Uq("notCalled",function(e){return!e.called},"expected %n to not have been called but was called %c%C"),Uq("calledOnce","expected %n to be called once but was called %c%C"),Uq("calledTwice","expected %n to be called twice but was called %c%C"),Uq("calledThrice","expected %n to be called thrice but was called %c%C"),Uq("calledOn","expected %n to be called with %1 as this but was called with %t"),Uq("alwaysCalledOn","expected %n to always be called with %1 as this but was called with %t"),Uq("calledWithNew","expected %n to be called with new"),Uq("alwaysCalledWithNew","expected %n to always be called with new"),Uq("calledWith","expected %n to be called with arguments %*%C"),Uq("calledWithMatch","expected %n to be called with match %*%C"),Uq("alwaysCalledWith","expected %n to always be called with arguments %*%C"),Uq("alwaysCalledWithMatch","expected %n to always be called with match %*%C"),Uq("calledWithExactly","expected %n to be called with exact arguments %*%C"),Uq("alwaysCalledWithExactly","expected %n to always be called with exact arguments %*%C"),Uq("neverCalledWith","expected %n to never be called with arguments %*%C"),Uq("neverCalledWithMatch","expected %n to never be called with match %*%C"),Uq("threw","%n did not throw exception%C"),Uq("alwaysThrew","%n did not always throw exception%C"),Pq?module.exports=Rq:Nq.assert=Rq),sinon}.call("undefined"!=typeof window&&window||{});